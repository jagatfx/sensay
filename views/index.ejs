<% layout( 'layout' ) -%>

<!-- <ul id="messages"></ul> -->
<!-- <form action="">
  <input id="m" autocomplete="off" /><button>Send</button>
</form> -->

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <div class="navbar-collapse collapse">
      <ul class="nav navbar-nav" id="main-menu">
        <li><a href="#top">Current Conversation</a>
        </li>
        <li><a href="#page-help">Help Button</a>
        </li>
        <li><a href="#page-sentiment">Overall Sentiment</a>
        </li>
      </ul>
    </div>
  </div>
</div>
<div class="container col-sm-12" id="main-container">
  <div class="container col-sm-9">
    <div class="container">
      <header class="section-header">
        <h4 class="section-title">Current Conversation</h4>
      </header>
    </div>
    <ul class="container" id="current-convo">

    </ul>
  </div>
  <div class="container col-sm-3">
    <div class="container col-sm-12" id="help-btn">
      <p>
        TEXT MANAGER FOR HELP
      </p>
    </div>
    <div class="container col-sm-12" id="overall-mood">
      <header class="section-header">
        <h4 class="section-title">Overall Conversation Mood</h4>
      </header>
    </div>
    <div class="container col-sm-12" id="graph">
      <header class="section-header">
        <h4 class="section-title">Graph</h4>
      </header>
    </div>
  </div>
</div>

<script src="/socket.io/socket.io.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
<script>
  var socket = io();
  // $('form').submit(function(){
  //   socket.emit('chat message', $('#m').val());
  //   $('#m').val('');
  //   return false;
  // });
  // socket.on('chat message', function(msg) {
  //   console.log('chat received');
  //   $('#messages').append($('<li>').text(msg));
  // });
  socket.on('tone', function(data) {
    console.log('tone received');
    $('#current-convo').append($('<li>').text(JSON.stringify(data.text)));
    // $('#messages').append($('<li>').text(JSON.stringify(data.result)));
  });
  socket.on('tones', function(tones) {
    console.log('tones received');
    for(var i=0; i < tones.length; i++) {
      var tone = tones[i];
      $('#current-convo').prepend($('<li>').text(JSON.stringify(tone.text)));
      // $('#messages').append($('<li>').text(JSON.stringify(tone.result)));
    }
  });
</script>
